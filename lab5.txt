#pelicula(nombre, anho, calificacion, estudio, ciudad, actor, personaje, genero)

P1
{nombre, anho, actor, personaje}
{actor} -> {genero}
{nombre, anho} -> {calificacion, estudio, ciudad}

P2
select * from lab5.pelicula as p1, lab5.pelicula as p2
where p1.actor = p2.actor
and p1.genero != p2.genero;

select * from lab5.pelicula as p1, lab5.pelicula as p2
where p1.nombre = p2.nombre
and p1.anho = p2.anho and (
p1.calificacion != p2.calificacion
or p1.estudio != p2.estudio
or p1.ciudad != p2.ciudad);

P3
Como se tiene {actor} -> {genero} y {nombre, anho} -> {calificacion, estudio, ciudad}, 
no cumple 2NF ya que {actor} y {nombre, anho} son subconjuntos de la llave candidata.


P4
create table lab5_p.lp_ja_pelicula_2fn (
	nombre varchar (255) not null,
	anho integer not null,
	calificacion float not null,
	estudio varchar (255) not null,
	ciudad varchar (255) not null,
	primary key(nombre, anho)
);
insert into lab5_p.lp_ja_pelicula_2fn (select distinct nombre, anho, calificacion, estudio, ciudad from lab5.pelicula);

create table lab5_p.lp_ja_actor_2fn (
	nombre varchar (255) primary key,
	genero varchar (1) not null
);
insert into lab5_p.lp_ja_actor_2fn (select distinct actor, genero from lab5.pelicula);

create table lab5_p.lp_ja_personaje_2fn (
	p_nombre varchar (255) ,
	p_anho integer ,
	actor varchar (255) ,
	personaje varchar (255) not null,
	foreign key (p_nombre, p_anho) references lab5_p.lp_ja_pelicula_2fn(nombre, anho),
	primary key(p_nombre, p_anho, actor, personaje)
);
insert into lab5_p.lp_ja_personaje_2fn (select distinct nombre, anho, actor, personaje from lab5.pelicula);

